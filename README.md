# PRI-YOLOv5

## <div align="center">Introduction</div>
<br>
<p>
PRI-YOLOv5 is an adaptation of YOLOv5 4.0. The network serves for the establishment of a system performance model. 
The whole principle of the network and the performance model will be find in our article. However, the article has not been published yet, 
and we will update the link to the article as soon as possible.
The source code of YOLOv5 4.0 can be downloaded in <a href="https://github.com/ultralytics/yolov5">Ultralytics</a>.
</p>



## <div align="center">Quick Start Examples</div>
<br>

<details open>
<summary>Install</summary>

```bash
$ pip install -r requirements.txt
```

[**Python>=3.6.0**](https://www.python.org/) is required with all requirements.txt installed 

</details>

<details open>
<summary>Data Preparation</summary>

Explain first: Refer to the article and the mission of PRI-YOLOv5, we define each target should belong to two categories here. It's class and type. 

In our article, we simulate six targets belonging to six classes from three different types. 

- Capture

Theoretically, the data may be collected by any common type of sensor or generated by simulation. 

For example, you can capture images of different kinds of targets in similar scenes to built a data set. Attention: Make sure you know the exact types of all the targets. 

Or you can download from the Internet through keyword search. Directly download an existing dataset may be tricky, as most datasets only provide classes not types of targets. 

In addition, we recommend only one or two targets in one image.

- Label 

After collecting enough images,  you should label them by LabelImg. Label them by their types first, and after the 'txt' generated, you should change them.  

Specifically, Change the index. 

For example, there are six targets:ship1~ship6, the cls index is '1' for ship1 during your label.

But as we define in coco128.yaml

```bash
# nc: 9  # number of classes
# names: ['frigate','destroyer','patrol','ship1','ship2','ship3','ship4','ship5','ship6']  # class names and type names
```
Note: ship1 and ship2 belong to frigate. 

Therefore, the index of ship1 should change from '1' to '03'.(index begin from zero in Python)

And we give an example in each ðŸ“‚ in ðŸ“‚datasets.

</details>

<details open>
<summary>How to run?</summary>

Attention: If you don't divide the targets into three classes and six types, please change the numbers in the corresponding position.

Or you can start as follows.

- wandb

Login your wandb account first. 

- Train

```bash
$ python train.py --data coco128.yaml --epoch 200 --imgsz 640 
```
Training results will be saved to runs/train/exp.

- Test

```bash
$ python detect.py 
```
Testing results will be saved to runs/detect/exp.
</details>


## <div align="center">Citation</div>
<br>
```bash
@code{YOLOv5,
  link = {https://github.com/ultralytics/yolov5},
  main contributor = {Glenn Jocher},
  year = {2020},
}
```

## <div align="center">Contact</div>
<br>
For any questions about running the code or any issues about building a data set, please contact us by email (gz18801366490@163.com).
If you are interested in our research direction and seeking for some collaborates or discussions, please contact us by email (angelniuniu@bit.edu.cn).
Thank you!
